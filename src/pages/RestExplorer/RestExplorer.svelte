<script lang="ts">
  // ---- View Model
  import RestExplorerViewModel from "./RestExplorer.ViewModel";

  import { user } from "$lib/store";
  import { DashboardViewModel } from "../Dashboard/Dashboard.ViewModel.old";
  import { RestExplorer } from "@workspaces/features";

  // TODO: Delete this code
  // let n = new DashboardViewModel();
  // user.subscribe(async (value) => {
  //   await n.refreshTeams(value._id);
  //   await n.refreshWorkspaces(value._id);
  // });

  export let tab;
  const _viewModel = new RestExplorerViewModel(tab);
</script>

<RestExplorer
  collections={_viewModel.collection}
  bind:requestUrl={_viewModel.requestUrl}
  bind:response={_viewModel.response}
  bind:requestParams={_viewModel.requestParams}
  bind:requestState={_viewModel.requestState}
  bind:requestBody={_viewModel.requestBody}
  bind:requestAutoGeneratedHeaders={_viewModel.requestAutoGeneratedHeaders}
  bind:requestMethod={_viewModel.httpMethod}
  bind:requestAuthHeader={_viewModel.authHeader}
  bind:requestAuthParameter={_viewModel.authParameter}
  bind:requestAuth={_viewModel.requestAuth}
  bind:requestName={_viewModel.requestName}
  bind:requestDescription={_viewModel.requestDescription}
  bind:requestPath={_viewModel.requestPath}
  bind:requestHeaders={_viewModel.requestHeaders}
  onSendRequest={_viewModel.sendRequest}
  onUpdateRequestUrl={_viewModel.updateRequestUrl}
  onUpdateRequestMethod={_viewModel.updateRequestMethod}
  onUpdateRequestParams={_viewModel.updateParams}
  onUpdateRequestName={_viewModel.updateRequestName}
  onUpdateRequestBody={_viewModel.updateRequestBody}
  onUpdateRequestAuth={_viewModel.updateRequestAuth}
  onUpdateHeaders={_viewModel.updateHeaders}
  onUpdateAutoGeneratedHeaders={_viewModel.updateAutoGeneratedHeaders}
  onUpdateRequestState={_viewModel.updateRequestState}
  onClearResponse={_viewModel.updateResponse}
  onSaveRequest={_viewModel.saveRequest}
  onUpdateRequestDescription={_viewModel.updateRequestDescription}
  readRequestOrFolderInCollection={_viewModel.readRequestOrFolderInCollection}
  readCollection={_viewModel.readCollection}
  readWorkspace={_viewModel.readWorkspace}
  onSaveAsRequest={_viewModel.saveAsRequest}
  onCreateFolder={_viewModel.createFolder}
  onCreateCollection={_viewModel.createCollection}
/>
